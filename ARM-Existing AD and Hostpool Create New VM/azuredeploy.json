{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",

"parameters": {
    "VmImageVhdUri": {
        "type": "string",
        "metadata": {
            "description": "URI for the VM Image VHD to use for RDSH instances. For example, https://rdsstorage.blob.core.windows.net/vhds/MyWindowServerOSImage.vhd"
        }
    },

    "rdshUpdateIteration": {
        "type": "string",
        "metadata": {
            "description": "A unique designator representing update iteration; newly created RDSH instances will have their names in the form: 'rdsh-&lt;index&gt;&lt;iteration&gt;"
        }
    },

    "rdshNumberOfInstances": {
        "type": "int",
        "metadata": {
            "description": "Number of RD Session Hosts"
        }
    },
    "rdshVmSize": {
        "type": "string",
        "allowedValues": [
          "Standard_A0",
          "Standard_A1",
          "Standard_A2",
          "Standard_A3",
          "Standard_A4",
          "Standard_A5",
          "Standard_A6",
          "Standard_A7",
          "Standard_D1",
          "Standard_D2",
          "Standard_D3",
          "Standard_D4",
          "Standard_D5"
        ],
        "metadata": {
          "description": "The size of the RDSH VMs"
        },
        "defaultValue": "Standard_A2"
    },
    "existingDomainName": {
        "type": "string",
        "metadata": {
            "description": "Domain name of the exisiting AD"
        }
    },
    "existingDomainUsername": {
        "type": "string",
        "metadata": {
            "description": "The name of administrator in the existing AD"
        }
    },
    "existingDomainPassword": {
        "type": "securestring",
        "metadata": {
            "description": "Domain administrator password"
        }
    },
    "existingVnetName": {
        "type": "string",
        "metadata": {
            "description": "VNET name"
        }
    },
    "existingSubnetName": {
        "type": "string",
        "metadata": {
            "description": "Subnet name"
        }
    },

    "userLogoffTimeoutInMinutes": {
        "type": "int",
        "defaultValue": 60,
        "metadata": {
            "description": "Timeout before forced user logoff from old RDSH instances"
        }
    },

    "userNotificationMessege ": {
        "type": "string",
        "defaultValue": "Scheduled maintenance, please save your work and logoff as soon as possible.",
        "metadata": {
            "description": "Message that will be displayed to the users"
        }

    },

    "RDBrokerURL":{
        "type": "string",
        "metadata": {
            "description": "The URL of RD Broker"
        }
    },
    
    "ExistingTenantName":{
        "type": "string",
        "metadata": {
            "description": "Existed Tenant Name"
        }
    },
    "ExistingHostPoolName":{
        "type": "string",
        "metadata": {
            "description": "Existing HostPool Name"
        }
    },
         
    "DelegatedAdminUsername":{
        "type": "string",
        "defaultvalue":"",
        "metadata": {
            "description": "Delegated admin username"
        }
    },
    "DelegatedAdminPassword":{
        "type": "securestring",
        "defaultvalue":"",
        "metadata": {
            "description": "Delegated admin Password"
        }
    }

},
"variables": {
    "iteration": "[toLower(parameters('rdshUpdateIteration'))]",
    "storageAccountName": "[split( split( parameters('VmImageVhdUri'), '/')[2], '.' )[0]]",
    "HostPoolFriendlyName": "Hostpool",
    "HostPoolDescription": "template through create hostpool",
    "RegistrationExpairationHours": "8760",
    "_artifactsLocation": "",
    "fileURI": "[concat(variables('_artifactsLocation'),'/Scripts/DeployAgent.zip')]"        
},
"resources": [
    
]
}

